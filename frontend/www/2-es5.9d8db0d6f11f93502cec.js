function _defineProperties(n,l){for(var e=0;e<l.length;e++){var t=l[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function _createClass(n,l,e){return l&&_defineProperties(n.prototype,l),e&&_defineProperties(n,e),n}function _classCallCheck(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{nylZ:function(n,l,e){"use strict";e.r(l);var t=e("8Y7J"),u=function n(){_classCallCheck(this,n)},i=e("pMnS"),o=e("MKJQ"),s=e("sZkV"),a=e("s7LF"),r=e("SVse"),c=e("n90K"),g=function(){function n(l,e,t,u){_classCallCheck(this,n),this.auth=l,this.storage=e,this.storageService=t,this.firestore=u,this.reply={content:"",metadata:{date:"",time:0,type:""}}}return _createClass(n,[{key:"ngOnInit",value:function(){var n=this;this.recipient=history.state.recipient,this.auth.currentUser.then((function(l){n.firestore.firestore.collection("users/"+l.uid+"/Chats").doc(n.recipient).onSnapshot((function(e){try{n.messages=e.data().Messages}catch(t){n.firestore.firestore.collection("users/"+l.uid+"/Chats").doc(n.recipient).set({Messages:[]}),n.ngOnInit()}}),(function(n){console.dir(n)})),n.storageService.get(l.uid).then((function(l){n.user=l})).catch((function(n){console.dir(n)}))}))}},{key:"sendMessage",value:function(){var n=this,l=new Date;this.reply.metadata.date=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate(),this.reply.metadata.time=l.getTime(),this.reply.metadata.type="sent",this.auth.currentUser.then((function(l){var e=l.uid;n.messages.push(n.reply),n.firestore.firestore.collection("users/"+l.uid+"/Chats").doc(n.recipient).update({Messages:n.messages}).then((function(){n.firestore.firestore.collection("users/"+n.recipient+"/Chats").doc(e).get().then((function(l){try{var t=l.data().Messages;n.reply.metadata.type="received",t.push(n.reply),n.firestore.firestore.collection("users/"+n.recipient+"/Chats").doc(e).update({Messages:t})}catch(u){n.reply.metadata.type="received",n.firestore.firestore.collection("users/"+n.recipient+"/Chats").doc(e).set({Messages:n.reply})}n.reply.content=""})).catch((function(n){console.dir(n)}))}))}))}}]),n}(),b=e("VRCc"),p=e("fMxG"),d=e("wD+u"),f=t.ob({encapsulation:0,styles:[['ion-header[_ngcontent-%COMP%]{position:absolute;height:30px;margin-top:10%;margin-bottom:10%}ion-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;color:#416;font-style:italic;font-family:cursive}.main-body[_ngcontent-%COMP%]{position:absolute;margin-top:30%}.innerMessage[_ngcontent-%COMP%]{position:relative;padding:5px 10px;background:#416;margin:5px;color:#fff;border-radius:3px;display:block}.innerMessage.messageRight[_ngcontent-%COMP%]{background:#d4af37;margin-left:25%;flex-wrap:wrap}.innerMessage.messageLeft[_ngcontent-%COMP%]{margin-right:25%}.message[_ngcontent-%COMP%]{font-size:120%}.elem[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;margin:0;position:absolute;top:0;left:0;width:100%;height:100%}.elem[_ngcontent-%COMP%]{position:relative;min-width:50px}div#footer[_ngcontent-%COMP%]   div.elem[_ngcontent-%COMP%]:first-child{flex-grow:1}div#footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:stretch}ion-input[_ngcontent-%COMP%]{padding-left:15px;font-size:125%}ion-toolbar[_ngcontent-%COMP%]{margin:0;padding:0!important}.innerMessage[_ngcontent-%COMP%]:after{content:"";display:block;clear:both}.messageLeft[_ngcontent-%COMP%]{float:left}.messageRight[_ngcontent-%COMP%]{float:right}']],data:{}});function h(n){return t.Hb(0,[(n()(),t.qb(0,0,null,null,3,"div",[],null,null,null,null,null)),(n()(),t.qb(1,0,null,null,2,"div",[],[[8,"className",0]],null,null,null,null)),(n()(),t.qb(2,0,null,null,1,"div",[["class","messageContent"]],null,null,null,null,null)),(n()(),t.Gb(3,null,["",""]))],null,(function(n,l){n(l,1,0,"sent"==l.context.$implicit.metadata.type?"innerMessage messageRight":"innerMessage messageLeft"),n(l,3,0,l.context.$implicit.content)}))}function m(n){return t.Hb(0,[(n()(),t.qb(0,0,null,null,7,"div",[["class","elem"]],null,null,null,null,null)),(n()(),t.qb(1,0,null,null,6,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var u=!0,i=n.component;return"ionBlur"===l&&(u=!1!==t.Cb(n,2)._handleBlurEvent(e.target)&&u),"ionChange"===l&&(u=!1!==t.Cb(n,2)._handleInputEvent(e.target)&&u),"ngModelChange"===l&&(u=!1!==(i.reply.content=e)&&u),u}),o.S,o.n)),t.pb(2,4341760,null,0,s.Gb,[t.p,t.k],null,null),t.Db(1024,null,a.e,(function(n){return[n]}),[s.Gb]),t.pb(4,671744,null,0,a.j,[[8,null],[8,null],[8,null],[6,a.e]],{model:[0,"model"]},{update:"ngModelChange"}),t.Db(2048,null,a.f,null,[a.j]),t.pb(6,16384,null,0,a.g,[[4,a.f]],null,null),t.pb(7,49152,null,0,s.D,[t.h,t.k,t.x],{type:[0,"type"]},null)],(function(n,l){n(l,4,0,l.component.reply.content),n(l,7,0,"text")}),(function(n,l){n(l,1,0,t.Cb(l,6).ngClassUntouched,t.Cb(l,6).ngClassTouched,t.Cb(l,6).ngClassPristine,t.Cb(l,6).ngClassDirty,t.Cb(l,6).ngClassValid,t.Cb(l,6).ngClassInvalid,t.Cb(l,6).ngClassPending)}))}function C(n){return t.Hb(0,[(n()(),t.qb(0,0,null,null,7,"ion-header",[],null,null,null,o.Q,o.l)),t.pb(1,49152,null,0,s.y,[t.h,t.k,t.x],null,null),(n()(),t.qb(2,0,null,0,5,"ion-toolbar",[],null,null,null,o.jb,o.E)),t.pb(3,49152,null,0,s.wb,[t.h,t.k,t.x],null,null),(n()(),t.qb(4,0,null,0,3,"ion-title",[],null,null,null,o.ib,o.D)),t.pb(5,49152,null,0,s.ub,[t.h,t.k,t.x],null,null),(n()(),t.qb(6,0,null,0,1,"h1",[],null,null,null,null,null)),(n()(),t.Gb(-1,null,["Chat"])),(n()(),t.qb(8,0,null,null,5,"ion-content",[["padding",""]],null,null,null,o.N,o.i)),t.pb(9,49152,null,0,s.r,[t.h,t.k,t.x],null,null),(n()(),t.qb(10,0,null,0,2,"div",[["id","chatMessages"]],null,null,null,null,null)),(n()(),t.fb(16777216,null,null,1,null,h)),t.pb(12,278528,null,0,r.h,[t.N,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(n()(),t.Gb(-1,0,["s "])),(n()(),t.qb(14,0,null,null,10,"ion-footer",[],null,null,null,o.O,o.j)),t.pb(15,49152,null,0,s.w,[t.h,t.k,t.x],null,null),(n()(),t.qb(16,0,null,0,8,"ion-toolbar",[],null,null,null,o.jb,o.E)),t.pb(17,49152,null,0,s.wb,[t.h,t.k,t.x],null,null),(n()(),t.qb(18,0,null,0,6,"div",[["id","footer"]],null,null,null,null,null)),(n()(),t.fb(16777216,null,null,1,null,m)),t.pb(20,16384,null,0,r.i,[t.N,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(21,0,null,null,3,"div",[["class","elem"]],null,null,null,null,null)),(n()(),t.qb(22,0,null,null,2,"button",[["icon-only",""],["ion-button",""]],null,[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.sendMessage()&&t),t}),null,null)),(n()(),t.qb(23,0,null,null,1,"ion-icon",[["name","send"]],null,null,null,o.R,o.m)),t.pb(24,49152,null,0,s.z,[t.h,t.k,t.x],{name:[0,"name"]},null)],(function(n,l){var e=l.component;n(l,12,0,e.messages),n(l,20,0,e.reply),n(l,24,0,"send")}),null)}var y=t.mb("app-message",g,(function(n){return t.Hb(0,[(n()(),t.qb(0,0,null,null,1,"app-message",[],null,null,null,C,f)),t.pb(1,114688,null,0,g,[b.a,p.a,c.a,d.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]),M=e("iInd"),v=function n(){_classCallCheck(this,n)};e.d(l,"MessagePageModuleNgFactory",(function(){return _}));var _=t.nb(u,[],(function(n){return t.zb([t.Ab(512,t.j,t.Y,[[8,[i.a,y]],[3,t.j],t.v]),t.Ab(4608,r.k,r.j,[t.s,[2,r.q]]),t.Ab(4608,a.l,a.l,[]),t.Ab(4608,s.a,s.a,[t.x,t.g]),t.Ab(4608,s.Ab,s.Ab,[s.a,t.j,t.p]),t.Ab(4608,s.Db,s.Db,[s.a,t.j,t.p]),t.Ab(1073742336,r.b,r.b,[]),t.Ab(1073742336,a.k,a.k,[]),t.Ab(1073742336,a.b,a.b,[]),t.Ab(1073742336,s.yb,s.yb,[]),t.Ab(1073742336,M.o,M.o,[[2,M.t],[2,M.m]]),t.Ab(1073742336,v,v,[]),t.Ab(1073742336,u,u,[]),t.Ab(1024,M.k,(function(){return[[{path:"",component:g}]]}),[])])}))}}]);