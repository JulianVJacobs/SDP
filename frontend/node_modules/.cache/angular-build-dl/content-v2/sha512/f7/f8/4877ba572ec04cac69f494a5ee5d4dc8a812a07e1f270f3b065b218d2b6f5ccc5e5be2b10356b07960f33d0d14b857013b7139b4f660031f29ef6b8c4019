(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{mX50:function(l,n,t){"use strict";t.r(n);var u=t("8Y7J");class e{}var o=t("pMnS"),i=t("MKJQ"),s=t("sZkV"),r=t("SVse"),c=t("n90K"),a=t("2g2N");class b{constructor(l,n,t,u,e,o){this.firestore=l,this.storage=n,this.auth=t,this.toast=u,this.storageService=e,this.router=o,this.items=[]}message(l){this.router.navigateByUrl("message",{state:{recipient:l.Owner}})}buy(l){this.user["Amount Left"]>=l.Price?this.auth.currentUser.then(n=>{this.user["Amount Left"]=this.user["Amount Left"]-parseFloat(l.Price),this.firestore.firestore.collection("users").doc(n.uid).update({"Amount Left":this.user["Amount Left"]}).then(()=>{this.firestore.firestore.collection("Books").doc(l.id).get().then(n=>{this.firestore.firestore.collection("Books").doc(l.id).delete().then(()=>{}).catch(l=>{console.dir(l)})}).catch(l=>{console.dir(l)}),this.firestore.firestore.collection("users").doc(l.Owner).get().then(n=>{var t=n.data();t["Amount Left"]+=parseFloat(l.Price),this.firestore.firestore.collection("users").doc(l.Owner).update({"Amount Left":t["Amount Left"]}).then(()=>{this.toast.presentToast("Successful purchase"),this.ngOnInit()}).catch(l=>{console.dir(l)})}).catch(l=>{console.dir(l)})}).catch(l=>{console.dir(l)})}).catch(l=>{console.dir(l)}):this.toast.presentToast("You don't have enough credits for that.")}ngOnInit(){this.auth.currentUser.then(l=>{this.storageService.get(l.uid).then(l=>{this.user=l,this.items=[],this.firestore.firestore.collection("Books").get().then(l=>{l.docs.forEach(l=>{var n=l.data();n.id=l.id,this.storage.storage.refFromURL(l.data()["Image-REF"][0]).getDownloadURL().then(l=>{n["Image-URL"]=l}).then(()=>{this.auth.currentUser.then(l=>{n.Owner!=l.uid&&this.items.push(n)})}).catch(l=>{console.dir(l)})})})})})}}var h=t("wD+u"),p=t("fMxG"),f=t("VRCc"),d=t("iInd"),g=u.ob({encapsulation:0,styles:[["ion-toolbar[_ngcontent-%COMP%]{position:absolute}ion-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;color:#d4af37;font-style:italic;font-family:cursive}ion-text[_ngcontent-%COMP%]{position:relative}ion-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;color:#416;font-style:italic;font-family:cursive;margin-top:30%}.actions[_ngcontent-%COMP%]{position:relative;margin-top:15%}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius:9px;--box-shadow:none;--background:linear-gradient(60deg, #D4AF37 0%, #416 100%);text-transform:initial;font-size:12px}.actions[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:14px}"]],data:{}});function m(l){return u.Hb(0,[(l()(),u.qb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"h2",[],null,null,null,null,null)),(l()(),u.Gb(2,null,["Balance: C ",""]))],null,(function(l,n){l(n,2,0,n.component.user["Amount Left"])}))}function x(l){return u.Hb(0,[(l()(),u.qb(0,0,null,null,16,"ion-card",[],null,null,null,i.L,i.d)),u.pb(1,49152,null,0,s.j,[u.h,u.k,u.x],null,null),(l()(),u.qb(2,0,null,0,0,"img",[["alt",""]],[[8,"src",4]],[[null,"srcChange"]],(function(l,n,t){var u=!0;return"srcChange"===n&&(u=!1!==(l.context.$implicit["Image-URL"]=t)&&u),u}),null,null)),(l()(),u.qb(3,0,null,0,13,"ion-list",[],null,null,null,i.V,i.q)),u.pb(4,49152,null,0,s.L,[u.h,u.k,u.x],null,null),(l()(),u.qb(5,0,null,0,1,"h1",[],null,null,null,null,null)),(l()(),u.Gb(6,null,["",""])),(l()(),u.qb(7,0,null,0,3,"ion-label",[],null,null,null,i.U,i.p)),u.pb(8,49152,null,0,s.K,[u.h,u.k,u.x],null,null),(l()(),u.Gb(9,0,["C "," "])),(l()(),u.qb(10,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),u.qb(11,0,null,0,2,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.buy(l.context.$implicit)&&u),u}),i.G,i.b)),u.pb(12,49152,null,0,s.h,[u.h,u.k,u.x],{expand:[0,"expand"]},null),(l()(),u.Gb(-1,0,["Buy"])),(l()(),u.qb(14,0,null,0,2,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.message(l.context.$implicit)&&u),u}),i.G,i.b)),u.pb(15,49152,null,0,s.h,[u.h,u.k,u.x],{expand:[0,"expand"]},null),(l()(),u.Gb(-1,0,["Contact Seller"]))],(function(l,n){l(n,12,0,"block"),l(n,15,0,"block")}),(function(l,n){l(n,2,0,n.context.$implicit["Image-URL"]),l(n,6,0,n.context.$implicit.Title),l(n,9,0,n.context.$implicit.Price)}))}function k(l){return u.Hb(0,[(l()(),u.qb(0,0,null,null,11,"ion-header",[],null,null,null,i.Q,i.l)),u.pb(1,49152,null,0,s.y,[u.h,u.k,u.x],null,null),(l()(),u.qb(2,0,null,0,9,"ion-toolbar",[],null,null,null,i.jb,i.E)),u.pb(3,49152,null,0,s.wb,[u.h,u.k,u.x],null,null),(l()(),u.qb(4,0,null,0,3,"ion-title",[],null,null,null,i.ib,i.D)),u.pb(5,49152,null,0,s.ub,[u.h,u.k,u.x],null,null),(l()(),u.qb(6,0,null,0,1,"h1",[],null,null,null,null,null)),(l()(),u.Gb(-1,null,["Buy Books"])),(l()(),u.qb(8,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,i.H,i.c)),u.pb(9,49152,null,0,s.i,[u.h,u.k,u.x],null,null),(l()(),u.qb(10,0,null,0,1,"ion-menu-button",[["menu","main-menu"]],null,null,null,i.W,i.s)),u.pb(11,49152,null,0,s.O,[u.h,u.k,u.x],{menu:[0,"menu"]},null),(l()(),u.qb(12,0,null,null,10,"ion-content",[["class","ion-padding"]],null,null,null,i.N,i.i)),u.pb(13,49152,null,0,s.r,[u.h,u.k,u.x],{fullscreen:[0,"fullscreen"]},null),(l()(),u.qb(14,0,null,0,8,"ion-list",[],null,null,null,i.V,i.q)),u.pb(15,49152,null,0,s.L,[u.h,u.k,u.x],null,null),(l()(),u.qb(16,0,null,0,3,"ion-text",[],null,null,null,i.gb,i.B)),u.pb(17,49152,null,0,s.rb,[u.h,u.k,u.x],null,null),(l()(),u.fb(16777216,null,0,1,null,m)),u.pb(19,16384,null,0,r.i,[u.N,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(20,0,null,0,2,"div",[["class","actions"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,x)),u.pb(22,278528,null,0,r.h,[u.N,u.J,u.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var t=n.component;l(n,11,0,"main-menu"),l(n,13,0,!0),l(n,19,0,t.user),l(n,22,0,t.items)}),null)}function A(l){return u.Hb(0,[(l()(),u.qb(0,0,null,null,1,"app-buy-books",[],null,null,null,k,g)),u.pb(1,114688,null,0,b,[h.a,p.a,f.a,a.a,c.a,d.m],null,null)],(function(l,n){l(n,1,0)}),null)}var q=u.mb("app-buy-books",b,A,{},{},[]),v=t("s7LF");class O{}t.d(n,"BuyBooksPageModuleNgFactory",(function(){return L}));var L=u.nb(e,[],(function(l){return u.zb([u.Ab(512,u.j,u.Y,[[8,[o.a,q]],[3,u.j],u.v]),u.Ab(4608,r.k,r.j,[u.s,[2,r.q]]),u.Ab(4608,v.l,v.l,[]),u.Ab(4608,s.a,s.a,[u.x,u.g]),u.Ab(4608,s.Ab,s.Ab,[s.a,u.j,u.p]),u.Ab(4608,s.Db,s.Db,[s.a,u.j,u.p]),u.Ab(1073742336,r.b,r.b,[]),u.Ab(1073742336,v.k,v.k,[]),u.Ab(1073742336,v.b,v.b,[]),u.Ab(1073742336,s.yb,s.yb,[]),u.Ab(1073742336,d.o,d.o,[[2,d.t],[2,d.m]]),u.Ab(1073742336,O,O,[]),u.Ab(1073742336,e,e,[]),u.Ab(1024,d.k,(function(){return[[{path:"",component:b}]]}),[])])}))}}]);